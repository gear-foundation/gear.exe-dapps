FROM node:18-alpine

MAINTAINER gear

WORKDIR /opt

COPY . .

RUN apk update

RUN apk add xsel

ARG VITE_WALLET_CONNECT_PROJECT_ID \
    VITE_GEAR_API_NODE \
    VITE_ETH_NODE_ADDRESS \
    VITE_CONTRACT_ADDRESS
ENV VITE_WALLET_CONNECT_PROJECT_ID=${VITE_WALLET_CONNECT_PROJECT_ID} \
    VITE_CONTRACT_ADDRESS=${VITE_CONTRACT_ADDRESS} \
    VITE_GEAR_API_NODE=${VITE_GEAR_API_NODE} \
    VITE_ETH_NODE_ADDRESS=${VITE_ETH_NODE_ADDRESS} \
    DISABLE_ESLINT_PLUGIN=true

RUN yarn install

RUN yarn build

RUN npm install --global serve

CMD ["serve", "-s", "/opt/dist"]
